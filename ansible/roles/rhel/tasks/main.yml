---
- name: Add DNS Entry to Enable Subscription to RHN
  lineinfile:
    dest: /etc/sysconfig/network-scripts/ifcfg-eth0
    line: "DNS1=209.132.186.218"

- name: Change DNS IP to External IP to Enable Subscription to RHN
  replace:
    dest: /etc/resolv.conf
    regexp: "nameserver 172.18.127.6"
    replace: "nameserver 209.132.186.218"

- name: Subscribe the host
  redhat_subscription:
    state: present
    username: "{{ rhn_user }}"
    password: "{{ rhn_password }}"
    autosubscribe: true
  when: os1_distro_variant == 'rhel'


- name: Install Basic Packages
  yum:
    name: "{{ item }}"
    state: latest
  #  enablerepo: rhel-7-server-optional-rpms
  with_items:
    - git
    - vim
    - unzip
  # - yum-cron
